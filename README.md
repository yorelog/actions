# Pe## 📂 当前工作流

### 🐳 Docker镜像同步 (`sync-images.yml`)
将Docker镜像从Docker Hub等源仓库同步到阿里云容器镜像服务，解决国内访问速度慢的问题。

#### 特性
- 🚀 **一键同步**：手动触发任意Docker镜像同步
- 💾 **磁盘优化**：智能清理系统空间，避免磁盘空间不足
- 🏷️ **灵活标记**：支持自定义目标标签和命名空间
- 🔍 **自动验证**：同步完成后自动验证镜像可用性
- 📊 **标签查询**：显示源镜像和目标镜像的可用标签

### 🚀 vLLM Docker镜像构建 (`build-vllm.yml`)
基于CUDA 12.4.1构建vLLM Docker镜像，支持选择GitHub release版本。

#### 特性
- 🔧 **版本选择**：支持选择vLLM的GitHub release版本
- 🇨🇳 **中国优化**：使用清华大学镜像源和Gitee仓库
- 💾 **激进清理**：释放5-15GB磁盘空间用于大型构建
- 🏗️ **智能构建**：预下载依赖，优化构建过程
- 🧪 **自动测试**：构建完成后自动测试镜像可用性

#### 构建参数
| 参数 | 描述 | 默认值 | 示例 |
|------|------|--------|------|
| vllm_version | vLLM版本 | v0.10.2 | v0.10.2 |
| cuda_version | CUDA版本 | 12.4 | 12.4 |
| python_version | Python版本 | 3.12 | 3.12 |
| torch_cuda_arch_list | CUDA架构列表 | 8.0 8.6 8.9 | 8.0 8.6 8.9 |
| target_namespace | 目标命名空间 | yoce | yoce |

#### 使用示例
```bash
# 构建结果示例
输入: vllm_version=v0.10.2, cuda_version=12.4
输出: registry.cn-beijing.aliyuncs.com/yoce/vllm:v0.10.2_cu124

# 使用构建的镜像
docker pull registry.cn-beijing.aliyuncs.com/yoce/vllm:v0.10.2_cu124
```ub Actions Collection

�️ 个人定制的GitHub Actions工作流集合，用于自动化各种开发和运维任务。

## � 当前工作流

### 🐳 Docker镜像同步 (`sync-images.yml`)
将Docker镜像从Docker Hub等源仓库同步到阿里云容器镜像服务，解决国内访问速度慢的问题。

#### 特性
- 🚀 **一键同步**：手动触发任意Docker镜像同步
- 💾 **磁盘优化**：智能清理系统空间，避免磁盘空间不足
- 🏷️ **灵活标记**：支持自定义目标标签和命名空间
- 🔍 **自动验证**：同步完成后自动验证镜像可用性
- 📊 **实时监控**：显示磁盘空间和Docker使用情况

#### 使用方法
1. **配置密钥**：在仓库Settings > Secrets中添加：
   - `ALIYUN_USERNAME`: 阿里云容器镜像服务用户名
   - `ALIYUN_PASSWORD`: 阿里云容器镜像服务密码

2. **手动触发**：
   - 进入Actions页面
   - 选择"Sync Images to Aliyun Registry"
   - 点击"Run workflow"
   - 填写参数

#### 参数说明
| 参数 | 描述 | 示例 | 必填 |
|------|------|------|------|
| 源镜像 | 要同步的源镜像完整名称 | `nvidia/cuda:12.4.1-cudnn-devel-ubuntu22.04` | ✅ |
| 目标标签 | 在阿里云中的标签名 | `12.4.1-cudnn-devel-ubuntu22.04` | ❌ |
| 目标命名空间 | 阿里云镜像仓库命名空间 | `yoce/cuda` | ❌ |

#### 使用示例
```bash
# 同步CUDA开发镜像
源镜像: nvidia/cuda:12.4.1-cudnn-devel-ubuntu22.04
→ registry.cn-beijing.aliyuncs.com/yoce/cuda:12.4.1-cudnn-devel-ubuntu22.04

# 同步Python镜像并重命名
源镜像: python:3.11-slim
目标标签: python-3.11-slim
→ registry.cn-beijing.aliyuncs.com/yoce/cuda:python-3.11-slim
```

## 🔮 计划添加的工作流

- **🤖 AI模型镜像构建**：其他AI框架（PyTorch、TensorFlow）的Docker镜像构建
- **🚀 自动部署工作流**：部署应用到各种云平台
- **📦 依赖更新工作流**：自动检查和更新项目依赖
- **🔍 代码质量检查**：自动化代码检查和测试
- **📊 性能监控工作流**：应用性能监控和报告
- **🔐 安全扫描工作流**：代码安全漏洞扫描
- **📝 文档生成工作流**：自动生成和部署文档
- **🏷️ 版本发布工作流**：自动化版本管理和发布

## � 工作流设计原则

1. **🎯 专注单一职责**：每个工作流专注解决特定问题
2. **💾 资源优化**：智能管理磁盘空间和资源使用
3. **🔧 灵活配置**：支持参数化配置和自定义
4. **📊 透明监控**：提供详细的执行状态和资源监控
5. **🛡️ 错误恢复**：具备失败重试和错误处理机制

## 🚀 快速开始

1. **Fork仓库**：将此仓库Fork到你的账户
2. **配置密钥**：根据各工作流要求配置相应的Secrets
3. **选择工作流**：在Actions页面选择需要的工作流
4. **运行测试**：先用小型任务测试工作流

## 📊 工作流性能优化

### 磁盘空间管理
- ✅ 任务开始前预清理系统垃圾
- ✅ 及时删除中间文件和临时数据
- ✅ 实时监控磁盘使用情况
- ✅ 智能缓存和资源复用

### 执行效率优化
- ✅ 并行执行非依赖任务
- ✅ 缓存常用依赖和工具
- ✅ 优化网络传输和镜像层
- ✅ 最小化重复操作

## 🤝 贡献指南

欢迎提交Issue和Pull Request来改进这些工作流：

1. **Bug报告**：发现问题请详细描述复现步骤
2. **功能建议**：建议新的工作流或优化现有功能
3. **代码贡献**：遵循现有代码风格和设计原则

## � 版本历史

### Docker镜像同步工作流
- **v1.0** - 基础镜像同步功能
- **v1.1** - 磁盘空间优化，提高稳定性
- **v1.2** - 简化设计，专注核心功能
- **v1.3** - 进一步磁盘优化，实时监控

---

💡 **使用提示**：这些工作流专为个人项目和小团队设计，注重实用性和资源效率。如有特殊需求，可以根据项目情况进行定制。